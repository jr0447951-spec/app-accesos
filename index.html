<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generador de Accesos</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
label { display: block; margin-top: 10px; }
select, input { width: 100%; padding: 8px; margin-top: 5px; }
button { margin-top: 15px; padding: 10px 20px; font-size: 16px; }
.checkbox-list { max-height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 5px; }
.checkbox-list label { display: block; }
</style>
</head>
<body>

  
<h2>Generador de Accesos</h2>

<!-- Sitio -->
<label for="sitioInput">Sitio:</label>
<input type="text" id="sitioInput" placeholder="Escribe para autocompletar">

<!-- Actividad -->
<label for="actividadInput">Actividad:</label>
<input type="text" id="actividadInput" placeholder="Escriba actividad">

<!-- Técnico Principal -->
<label for="tecnicoPrincipalSelect">Técnico Principal:</label>
<select id="tecnicoPrincipalSelect"></select>

<!-- Técnicos Adicionales -->
<label>Técnicos Adicionales:</label>
<div class="checkbox-list" id="tecnicosAdicionalesDiv"></div>

<!-- Vehículo -->
<label>Placa:</label>
<input type="text" id="placaInput">
<label>Marca:</label>
<input type="text" id="marcaInput">
<label>Modelo:</label>
<input type="text" id="modeloInput">
<label>Color:</label>
<input type="text" id="colorInput">

<!-- Botón Generar Mensaje -->
<button id="generarBtn">Generar Mensaje y WhatsApp</button>

<script>
// --- Datos de ejemplo (reemplazar con CSV parseados) ---
const sitios = [
  { SiteID: '390502', Nombre: 'SENSUNTEPEQUE', Torrero: 'TORRECOM', NombreTorrero: 'TSVTF09295 SENSUNTEPEQUE' },
  { SiteID: '391025', Nombre: 'AMATECAMPO', Torrero: 'TORREAM', NombreTorrero: 'ABC123 AMATECAMPO' }
];

const tecnicos = [
  { TECNICO: 'Jose Edilberto Rivas Rivas', DUI: '05366673-2', TELEFONO: '+503 61614465', CORREO: 'jose.rivas@celectcac.com', FECHA_NACIMIENTO: '19/06/96' },
  { TECNICO: 'Luis Antonio Palacios Gomez', DUI: '05587930-7', TELEFONO: '+503 12345678', CORREO: 'luis.palacios@celectcac.com', FECHA_NACIMIENTO: '07/06/66' },
  { TECNICO: 'Ronald Alexander Gonzalez Orellana', DUI: '04937910-3', TELEFONO: '+503 87654321', CORREO: 'ronald.gonzalez@celectcac.com', FECHA_NACIMIENTO: '21/09/76' },
  { TECNICO: 'Miguel Alfredo Ochoa Osorio', DUI: '00975466-4', TELEFONO: '+503 55555555', CORREO: 'miguel.ochoa@celectcac.com', FECHA_NACIMIENTO: '17/06/94' }
];

// --- Autocompletar sitio ---
const sitioInput = document.getElementById('sitioInput');
let sitioSeleccionado = null;

sitioInput.addEventListener('input', () => {
  const val = sitioInput.value.toUpperCase();
  const match = sitios.find(s => s.Nombre.toUpperCase().includes(val));
  if (match) sitioSeleccionado = match;
});

// --- Cargar técnico principal ---
const tecnicoPrincipalSelect = document.getElementById('tecnicoPrincipalSelect');
tecnicos.forEach(t => {
  const opt = document.createElement('option');
  opt.value = t.TECNICO;
  opt.textContent = `${t.TECNICO} (${t.DUI})`;
  tecnicoPrincipalSelect.appendChild(opt);
});

// --- Cargar técnicos adicionales ---
const tecnicosAdicionalesDiv = document.getElementById('tecnicosAdicionalesDiv');
function renderCheckboxes() {
  tecnicosAdicionalesDiv.innerHTML = '';
  tecnicos.forEach(t => {
    const chk = document.createElement('input');
    chk.type = 'checkbox';
    chk.id = t.TECNICO;
    chk.value = t.TECNICO;

    // Evitar que técnico principal se pueda seleccionar
    if (t.TECNICO === tecnicoPrincipalSelect.value) chk.disabled = true;

    const label = document.createElement('label');
    label.htmlFor = t.TECNICO;
    label.textContent = `${t.TECNICO} (${t.DUI})`;

    label.prepend(chk);
    tecnicosAdicionalesDiv.appendChild(label);
  });
}

// Inicial render
renderCheckboxes();

// Actualizar checkbox cuando cambia técnico principal
tecnicoPrincipalSelect.addEventListener('change', renderCheckboxes);

// --- Botón Generar Mensaje ---
document.getElementById('generarBtn').addEventListener('click', () => {
  if (!sitioSeleccionado) {
    alert('Seleccione un sitio válido');
    return;
  }

  const actividad = document.getElementById('actividadInput').value || '';

  // Vehículo
  const veh = {
    Placa: document.getElementById('placaInput').value,
    Marca: document.getElementById('marcaInput').value,
    Modelo: document.getElementById('modeloInput').value,
    Color: document.getElementById('colorInput').value
  };

  // Técnico principal
  const tecnicoPrincipal = tecnicos.find(t => t.TECNICO === tecnicoPrincipalSelect.value);

  // Técnicos adicionales
  const tecnicosAdicionales = Array.from(document.querySelectorAll('#tecnicosAdicionalesDiv input:checked'))
    .map(c => tecnicos.find(t => t.TECNICO === c.value));

  // Construir lista de técnicos final
  let listaTecnicos = [];
  listaTecnicos.push(`${tecnicoPrincipal.TECNICO}\t${tecnicoPrincipal.DUI} (${tecnicoPrincipal.FECHA_NACIMIENTO})`);
  tecnicosAdicionales.forEach(t => {
    if (t.TECNICO !== tecnicoPrincipal.TECNICO) {
      listaTecnicos.push(`${t.TECNICO}\t${t.DUI} (${t.FECHA_NACIMIENTO})`);
    }
  });
  const bloqueTecnicos = listaTecnicos.join('\n');

  // Mensaje final
  const mensaje = `BUEN DIA
SU AYUDA CON EL SIGUIENTE ACCESO POR FAVOR :
▬▬▬▬▬▬▬▬▬▬
ID:${sitioSeleccionado.SiteID}
NOMBRE: ${sitioSeleccionado.Nombre}
PROPIETARIO: ${sitioSeleccionado.Torrero}
Nombre Torrero ${sitioSeleccionado.NombreTorrero}
▬▬▬▬▬▬▬▬▬▬
ACTIVIDAD: ${actividad}
▬▬▬▬▬▬▬▬▬▬
TECNICO PRINCIPAL/DUI
${bloqueTecnicos}
▬▬▬▬▬▬▬▬▬▬
Placa: ${veh.Placa}
Marca: ${veh.Marca}
Modelo: ${veh.Modelo}
Color: ${veh.Color}
▬▬▬▬▬▬▬▬▬▬
TELEFONO: ${tecnicoPrincipal.TELEFONO}
CORREO: ${tecnicoPrincipal.CORREO} tecnicossv@celectcac.com
`;

  // --- Enviar a WhatsApp ---
  const urlWhatsApp = `https://wa.me/?text=${encodeURIComponent(mensaje)}`;
  window.open(urlWhatsApp, '_blank');
});
</script>
</body>
</html>




