<!DOCTYPE html>
<html lang="es">
<head>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0078D4">
<meta charset="UTF-8">
<title>Generador de Mensaje de Acceso</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  padding: 15px;
}
h2 { text-align: center; }
label { font-weight: bold; margin-top: 10px; display:block; }
select, button, textarea {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
}
textarea {
  height: 260px;
  white-space: pre-wrap;
}
button {
  background: #0078D4;
  color: white;
  border: none;
  margin-top: 15px;
  font-size: 16px;
}
</style>
</head>

<body>

<h2>üìã Generar Mensaje de Acceso</h2>

<label>T√©cnico principal</label>
<select id="tecnicoPrincipal"></select>

<label>Otros t√©cnicos (Ctrl para varios)</label>
<select id="otrosTecnicos" multiple size="4"></select>

<label>Actividad</label>
<select id="actividad"></select>

<label>Veh√≠culo</label>
<select id="vehiculo"></select>

<button onclick="generarMensaje()">Generar y Copiar</button>

<textarea id="resultado" readonly></textarea>

<script>
// =======================
// DATOS (PUEDES EDITAR)
// =======================

const correoFijo = "tecnicossv@celectcac.com";

const tecnicos = [
  {nombre:"Douglas Rony Ventura Portillo", dui:"01315412-7", telefono:"+503 6176 4016", correo:"Douglas.ventura@celectcac.com"},
  {nombre:"Jos√© Adalberto Palma Cruz", dui:"05702614-6", telefono:"+503 7000 0000", correo:"jose.palma@correo.com"}
];

const actividades = [
  "Servicio parcial",
  "Mantenimiento",
  "Instalaci√≥n"
];

const vehiculos = [
  {placa:"P6348D", marca:"NISSAN", modelo:"NP300", color:"BLANCO"}
];

// =======================
// CARGAR LISTAS
// =======================

window.onload = () => {
  const tp = document.getElementById("tecnicoPrincipal");
  const ot = document.getElementById("otrosTecnicos");
  const ac = document.getElementById("actividad");
  const vh = document.getElementById("vehiculo");

  tecnicos.forEach((t,i)=>{
    tp.add(new Option(t.nombre, i));
    ot.add(new Option(t.nombre, i));
  });

  actividades.forEach(a=>ac.add(new Option(a,a)));

  vehiculos.forEach((v,i)=>{
    vh.add(new Option(v.placa + " - " + v.marca, i));
  });
};

// =======================
// GENERAR MENSAJE
// =======================

function generarMensaje(){
  const tpIndex = tecnicoPrincipal.value;
  const tecnicoP = tecnicos[tpIndex];
  const actividad = document.getElementById("actividad").value;
  const vehiculo = vehiculos[document.getElementById("vehiculo").value];

  let listaTecnicos = `${tecnicoP.nombre}\t${tecnicoP.dui}\n`;

  Array.from(otrosTecnicos.selectedOptions).forEach(o=>{
    if(o.value != tpIndex){
      const t = tecnicos[o.value];
      listaTecnicos += `${t.nombre}\t${t.dui}\n`;
    }
  });

  const mensaje = 
`BUEN DIA
SU AYUDA CON EL SIGUIENTE ACCESO POR FAVOR :
‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨
ID:390241
NOMBRE: SAN LUIS TALPA
PROPIETARIO: SBA
ES18E7A-A San Luis Talpa
‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨
ACTIVIDAD: ${actividad}
‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨
TECNICO/DUI
${listaTecnicos}‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨
Placa: ${vehiculo.placa}
Marca: ${vehiculo.marca}
Modelo: ${vehiculo.modelo}
Color: ${vehiculo.color}
‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨‚ñ¨
TELEFONO: ${tecnicoP.telefono}
CORREO: ${tecnicoP.correo}; ${correoFijo}`;

  document.getElementById("resultado").value = mensaje;

  navigator.clipboard.writeText(mensaje)
    .then(()=>alert("‚úÖ Mensaje copiado al portapapeles"))
    .catch(()=>alert("‚ùå No se pudo copiar"));
}
</script>
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
