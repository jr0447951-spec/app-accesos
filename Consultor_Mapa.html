<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Consultor de Sitios</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  min-height:100vh;
  font-family: system-ui, -apple-system, Segoe UI, Roboto;
  background: linear-gradient(180deg,#f7f9fc,#eef2f7);
  display:flex;
  justify-content:center;
  align-items:flex-start;
}

.app{
  width:100%;
  max-width:560px;
  padding:18px 16px 32px;
}

h1{
  text-align:center;
  font-size:1.3rem;
  margin:6px 0 14px;
  color:#1f2937;
}

input{
  width:100%;
  padding:16px;
  font-size:1rem;
  border-radius:18px;
  border:1px solid #d1d5db;
  background:#ffffff;
  box-shadow:0 4px 14px rgba(0,0,0,.06);
}

.suggestions{
  margin-top:8px;
  background:#ffffff;
  border-radius:18px;
  box-shadow:0 10px 28px rgba(0,0,0,.14);
  max-height:260px;
  overflow-y:auto;
}

.suggestions div{
  padding:14px;
  cursor:pointer;
}

.suggestions div:hover{
  background:#f2f5f9;
}

.card{
  margin-top:20px;
  background:#ffffff;
  border-radius:26px;
  box-shadow:0 18px 40px rgba(0,0,0,.12);
  overflow:hidden;
}

.card-header{
  padding:16px 18px;
  background: linear-gradient(135deg,#e0eaff,#f0f4ff);
  color:#1a3faa;
}

.card-header h2{
  margin:0;
  font-size:1.05rem;
  line-height:1.4;
  text-align:center;
}

.map-preview{
  width:100%;
  height:180px;
  margin:14px 0;
  border-radius:20px;
  overflow:hidden;
  box-shadow:0 8px 22px rgba(0,0,0,.12);
}

.map-preview iframe{
  width:100%;
  height:100%;
  border:0;
}

.table{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px 16px;
  padding:16px 18px 6px;
}

.row-label{
  color:#6b7280;
  font-size:.88rem;
}

.row-value{
  font-weight:600;
  color:#111827;
}

.full{
  grid-column:1 / -1;
}

.badge-yes{
  color:#b91c1c;
  font-weight:700;
}

.badge-no{
  color:#15803d;
  font-weight:700;
}

.card-footer{
  padding:18px;
}

.btn{
  width:100%;
  padding:18px;
  border:none;
  border-radius:20px;
  background:linear-gradient(135deg,#2563eb,#1d4ed8);
  color:white;
  font-size:1.05rem;
  font-weight:700;
  box-shadow:0 10px 26px rgba(37,99,235,.35);
}
</style>
</head>

<body>
<div class="app">
  <h1>Consulta de Sitios</h1>

  <input id="search" placeholder="Buscar por nombre del sitio" autocomplete="off">
  <div id="sug" class="suggestions" style="display:none"></div>

  <div id="result"></div>
</div>

<script>
const CSV_URL = "https://raw.githubusercontent.com/USUARIO/REPOSITORIO/main/Mapa_Base.csv";

let data = [];

fetch(CSV_URL)
  .then(r => r.text())
  .then(text => {
    const lines = text.trim().split("\n");
    const headers = lines.shift().split(";");

    data = lines.map(line => {
      const values = line.split(";");
      const obj = {};
      headers.forEach((h,i)=> obj[h.trim()] = values[i]?.trim());
      return obj;
    });
  });

const search = document.getElementById("search");
const sug = document.getElementById("sug");
const result = document.getElementById("result");

search.addEventListener("input",()=>{
  const v = search.value.toLowerCase();
  sug.innerHTML="";
  if(!v){sug.style.display="none";return;}

  data.filter(d => d["NOMBRE DE SITIO"]?.toLowerCase().includes(v))
      .slice(0,6)
      .forEach(d=>{
        const div=document.createElement("div");
        div.textContent=d["NOMBRE DE SITIO"];
        div.onclick=()=>selectSite(d);
        sug.appendChild(div);
      });

  sug.style.display="block";
});

function selectSite(d){
  sug.style.display="none";
  search.value=d["NOMBRE DE SITIO"];

  result.innerHTML=`
    <div class="card">

      <div class="card-header">
        <h2>${d.SITEID} - ${d["NOMBRE DE SITIO"]}</h2>
      </div>

      <div class="map-preview">
        <iframe
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=${d.LATITUDE},${d.LONGITUDE}&z=15&output=embed">
        </iframe>
      </div>

      <div class="table">
        <div class="row-label">NIC/NIS</div><div class="row-value">${d["NIC/NIS"]}</div>
        <div class="row-label">Distribuidora</div><div class="row-value">${d.Distribuidora}</div>

        <div class="row-label">Llave requerida</div>
        <div class="row-value ${d["Llave Requerida"] === "SI" ? "badge-yes" : "badge-no"}">
          ${d["Llave Requerida"]}
        </div>

        <div class="row-label">Altura</div><div class="row-value">${d.Altura} m</div>
        <div class="row-label">In-Building</div><div class="row-value">${d["In-Building"]}</div>
        <div class="row-label">Support Type</div><div class="row-value">${d["Support Type"]}</div>
        <div class="row-label">Porte</div><div class="row-value">${d.Porte}</div>
        <div class="row-label">Tecnolog√≠a</div><div class="row-value">${d.Tech}</div>
        <div class="row-label">Transmisi√≥n</div><div class="row-value">${d["Tipo de Transmision"]}</div>
        <div class="row-label">Propietario</div><div class="row-value">${d.Propietario}</div>
        <div class="row-label">Tipo Ubicaci√≥n</div><div class="row-value">${d["Tipo Ubicacion"]}</div>

        <div class="row-label full">Direcci√≥n</div>
        <div class="row-value full">${d.Direccion}</div>

        <div class="row-label">Municipio</div>
        <div class="row-value">${d.Municipio}</div>
      </div>

      <div class="card-footer">
        <button class="btn"
          onclick="window.open('https://www.google.com/maps/dir/?api=1&destination=${d.LATITUDE},${d.LONGITUDE}','_blank')">
          üìç Ir a Google Maps
        </button>
      </div>

    </div>
  `;
}
</script>
</body>
</html>
